<div class="container">
  <div class="row">
    <div class="col-sm-3 mb-3">
      <button class="btn btn-outline-primary" (click)="goBack()">
        <span class="material-icons">arrow_back</span> {{ 'Back' | translate }}
      </button>
    </div>
  </div>
</div>

@if (queryResults()?.feedback?.comments?.length) {
  <upd-alert position="top" [selfClosing]="true">
    {{ 'success-generating-report' | translate }}
  </upd-alert>
}

<div class="card-container mt-3">
  <div class="card">
    <h5 class="card-header">{{ 'Report details' | translate }}</h5>
    <div class="card-body">
      <div class="report-detail">
        <div class="d-flex align-items-center justify-content-start gap-2 mb-2">
          <h6 class="mb-1">{{ 'Date range' | translate }}:</h6>
          {{ startDate() | translate }} {{ 'to' | translate }}
          {{ endDate() | translate }}
        </div>

        <div class="d-flex align-items-center justify-content-start gap-2 mb-2">
          <h6 class="mb-1">{{ 'items' | translate }}:</h6>
        </div>
        <upd-accordion
          [styleClass]="'mb-2'"
          [expanded]="selectedCount() < 10"
          title="{{
            'Items added to report'
              | translate
                : {
                    count: selectedCount(),
                  }
          }} "
        >
          @if (selectedPagesCount()) {
            <p class="fw-bold">{{ 'pages' | translate }}</p>
          }
          <ul>
            <li *ngFor="let page of selectedPages()">
              {{ page.title }}
            </li>
          </ul>
          @if (selectedTasksCount()) {
            <p class="fw-bold">{{ 'tasks' | translate }}</p>
          }
          <ul>
            <li *ngFor="let task of selectedTasks()">
              {{ task.title | translate }}
              {{ 'page-count' | translate: { count: task.pages.length } }}
            </li>
          </ul>
          @if (selectedProjectsCount()) {
            <p class="fw-bold">{{ 'ux-projects' | translate }}</p>
          }
          <ul>
            <li *ngFor="let project of selectedProjects()">
              {{ project.title | translate }}
              {{ 'page-count' | translate: { count: project.pages.length } }}
            </li>
          </ul>
        </upd-accordion>
      </div>
    </div>
  </div>

  <div class="w-100 d-inline-block mx-mx-auto mt-4">
    <div class="d-flex flex-fill align-content-center h-100 w-100">
      <div class="card align-middle w-100">
        <div class="card-body">
          <div>
            <upd-data-table
              #dataTable
              id="pages-home-"
              [data]="commentsData()"
              [cols]="columnsComments"
              [displayRows]="50"
              [loading]="queryResults() === null"
            >
            </upd-data-table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
